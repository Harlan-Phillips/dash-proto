 <div className="flex-1 flex overflow-hidden min-h-0">
                {/* Fixed Table of Contents Sidebar - Google Docs Style */}
                {activeTab === "detailed" && (
                   <aside className="hidden lg:flex w-56 shrink-0 border-r border-gray-200 bg-white flex-col h-full overflow-y-auto">
                      <div className="p-4 border-b border-gray-100">
                         <h3 className="text-xs font-bold text-gray-500 uppercase tracking-wider flex items-center gap-2">
                            <List className="h-3.5 w-3.5" />
                            Document Outline
                         </h3>
                      </div>
                      <nav className="flex-1 overflow-y-auto p-3">
                         {tocSections.map((section, index) => (
                            <button
                               key={section.id}
                               data-testid={`toc-link-${section.id}`}
                               onClick={() => scrollToSection(section.id)}
                               className={cn(
                                  "w-full text-left px-3 py-2.5 rounded-lg text-sm transition-all duration-150 flex items-center gap-3 mb-1",
                                  activeSection === section.id
                                     ? "bg-black text-white font-medium shadow-sm"
                                     : "text-gray-600 hover:bg-gray-100 hover:text-gray-900"
                               )}
                            >
                               <span className={cn(
                                  "w-5 h-5 rounded-full flex items-center justify-center text-xs font-medium shrink-0",
                                  activeSection === section.id
                                     ? "bg-white/20 text-white"
                                     : "bg-gray-100 text-gray-500"
                               )}>
                                  {index + 1}
                               </span>
                               {section.label}
                            </button>
                         ))}
                      </nav>
                   </aside>
                )}